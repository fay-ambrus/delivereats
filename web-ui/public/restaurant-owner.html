<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Restaurant Owner - DeliverEats</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app">
    <h1>Restaurant Management</h1>

    <div v-if="!selectedRestaurant">
      <h2>Select restaurant</h2>
      <select v-model="selectedRestaurantId">
        <option value="">-- Choose a restaurant --</option>
        <option v-for="restaurant in restaurants" :value="restaurant.id">
          {{ restaurant.name }}
        </option>
      </select>
      <button @click="selectRestaurant" :disabled="!selectedRestaurantId">Continue</button>

      <h2>Create new restaurant</h2>
      <input v-model="newRestaurantName" placeholder="Restaurant name">
      <button @click="addRestaurant" :disabled="!newRestaurantName">Add</button>
    </div>

    <div v-else>
      <h2>{{ selectedRestaurant.name }}</h2>

      <h3>Restaurant details</h3>
      <label>Category:</label><br>
      <input v-model="restaurantCategory" placeholder="Restaurant category"><br>
      <button @click="updateRestaurantCategory">Save category</button>

      <h3>Menu Items</h3>
      <table border="1">
        <thead>
          <tr>
            <th>Name</th>
            <th>Price (HUF)</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="item in menuItems" :key="item.id">
            <template v-if="editingItem && editingItem.id === item.id">
              <td><input v-model="editingItem.name"></td>
              <td><input v-model="editingItem.priceHUF" type="integer"></td>
              <td>
                <button @click="saveItem">Save</button>
                <button @click="cancelEdit">Cancel</button>
              </td>
            </template>
            <template v-else>
              <td>{{ item.name }}</td>
              <td>{{ item.priceHUF }}</td>
              <td>
                <button @click="editItem(item)">Edit</button>
                <button @click="deleteItem(item.id)">Delete</button>
              </td>
            </template>
          </tr>
        </tbody>
      </table>

      <h4>Add New Item</h4>
      <input v-model="newItem.name" placeholder="Item name">
      <input v-model="newItem.priceHUF" type="number" placeholder="Price (HUF)">
      <button @click="addMenuItem">Add Item</button><br><br>

      <h3>Incoming orders</h3>
      <div v-if="restaurantOrders.length === 0">
        <p>No orders yet</p>
      </div>
      <div v-else>
        <div v-for="order in restaurantOrders" :key="order.id">
          <h4>Order #{{ order.id }} - {{ order.status }}</h4>
          <ul>
            <li v-for="item in order.items" :key="item.menuItemId">
              {{ getMenuItemName(item.menuItemId) }} x {{ item.quantity }}
            </li>
          </ul>
        </div>
      </div>

      <button @click="selectedRestaurant = null">Back to restaurant selector</button>
    </div>
  </div>

  <script src="restaurant-owner.js"></script>
</body>
</html>
